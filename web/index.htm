<!DOCTYPE html> 
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<title>Door2Door GIS Code Challenge - Rouven Volkmann</title>
<link rel="stylesheet" href="leaflet.css" />
<style>
	html, body, #mapid {
      height:100%;
      width:100%;
      padding:0px;
      margin:0px;
   }
</style>

<script src="leaflet.js"></script>
<script src="leaflet.ajax.min.js"></script>

<script>
function initmap(){
	var map = L.map('mapid').setView([-6.816667, 39.283889], 12);
	L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
		attribution: 'Tiles by <a href="http://mapc.org">MAPC</a>, Data by <a href="http://mass.gov/mgis">MassGIS</a>',
		maxZoom: 19,
		minZoom: 11
	}).addTo(map);

	function bus_stops_popup(feature, layer){
		layer.bindPopup('Cluster-ID: ' + feature.properties.cluster_id + '<br />Number of Activities: ' + feature.properties.num_activity_points);
	}

	var bus_stops_style = {
				radius: 8,
				fillColor: "#ff7800",
				color: "#000",
				weight: 1,
				opacity: 1,
				fillOpacity: 0.8
	}
	
	var bus_stops_style_red = {
				radius: 12,
				fillColor: "#ff0000",
				color: "#000",
				weight: 1,
				opacity: 1,
				fillOpacity: 0.8
	}

	var bus_stops = new L.GeoJSON.AJAX("../data/bus_stops.geojson",{
		onEachFeature: bus_stops_popup,
		pointToLayer: function (feature, latlng) {
				if (feature.properties.num_activity_points < 10){
					return L.circleMarker(latlng, bus_stops_style);
				}
				else {
					return L.circleMarker(latlng, bus_stops_style_red);
				}
			}
		}
	);
	 
	bus_stops.addTo(map);

}
</script>


<body onload='initmap();'>
<div id="mapid"></div>


</body>

</html>
