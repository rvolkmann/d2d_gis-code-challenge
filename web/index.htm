<!DOCTYPE html> 
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<title>Door2Door GIS Code Challenge - Rouven Volkmann</title>
<link rel="stylesheet" href="leaflet.css" />
<style>
	html, body, #mapid {
      height:100%;
      width:100%;
      padding:0px;
      margin:0px;
   }
</style>

<script src="leaflet.js"></script>
<script src="leaflet.ajax.min.js"></script>

<script>
function initmap(){
	
	var map = L.map('mapid').setView([-6.816667, 39.283889], 12);
	
	var osm = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
		attribution: '© OpenStreetMap contributors',
		maxZoom: 19,
		minZoom: 11
	});

	var otm = L.tileLayer('http://tile.opentopomap.org/{z}/{x}/{y}.png',{
		attribution: '© OpenStreetMap contributors',
		maxZoom: 19,
		minZoom: 11
	});

	var oepnv = L.tileLayer('http://tile.memomaps.de/tilegen/{z}/{x}/{y}.png',{
		attribution: '© OpenStreetMap contributors',
		maxZoom: 19,
		minZoom: 11
	});

 

	function bus_stops_popup(feature, layer){
		layer.bindPopup('Cluster-ID: ' + feature.properties.cluster_id + '<br />Number of Activities: ' + feature.properties.num_activity_points);
	}

	var bus_stops_style_small = {
				radius: 4,
				fillColor: "#ff7800",
				color: "#000",
				weight: 1,
				opacity: 1,
				fillOpacity: 0.6
	}
	
	var bus_stops_style_medium = {
				radius: 8,
				fillColor: "#ff7800",
				color: "#000",
				weight: 1,
				opacity: 1,
				fillOpacity: 0.6
	}

	var bus_stops_style_big = {
				radius: 12,
				fillColor: "#ff0000",
				color: "#000",
				weight: 1,
				opacity: 1,
				fillOpacity: 0.6
	}

	var bus_stops = new L.GeoJSON.AJAX("../data/bus_stops.geojson",{
		onEachFeature: bus_stops_popup,
		pointToLayer: function (feature, latlng) {
				if (feature.properties.num_activity_points < 3){
					return L.circleMarker(latlng, bus_stops_style_small);
				}
				else if (feature.properties.num_activity_points < 10){
					return L.circleMarker(latlng, bus_stops_style_medium);
				}
				else {
					return L.circleMarker(latlng, bus_stops_style_big);
				}
			}
		}
	);
	
	var routes = new L.GeoJSON.AJAX("../data/routes.geojson");
	var aps = new L.GeoJSON.AJAX("../data/activity_points.geojson");
	var overlayMaps = { "Bus Stops": bus_stops, "Bus Routes": routes, "Activity Points":aps };
	var baseMaps = { "OpenStreetMap": osm, "OpenTopoMap": otm, "ÖPNV Map": oepnv };
	
	oepnv.addTo(map);
	bus_stops.addTo(map);
	L.control.layers(baseMaps,overlayMaps).addTo(map);
}
</script>


<body onload='initmap();'>
<div id="mapid"></div>


</body>

</html>
